!function(w){"use strict";function o(t,o){this.ele=w(t),this.wrapper=null,this.product=null,this.pid="popover_"+(new Date).getTime(),this.timer_in=null,this.timer_out=null,this.mouse=!1,this.posMap=["topLeft","top","topRight","rightTop","right","rightBottom","bottomLeft","bottom","bottomRight","leftTop","left","leftBottom"],this.posId=1,this.opts=w.extend({},i,o);for(var e=this.posMap.length-1;0<=e;e--)if(this.opts.placement===this.posMap[e]){this.posId=e;break}this.init()}var i={trigger:"hover",autoPlace:!0,delay:10,placement:"top",title:"",content:""};o.prototype.init=function(){this.bind()},o.prototype.render=function(){var t=this,o=this.pid,e=w(document.body),i="function"==typeof t.opts.content?t.opts.content.call(this):"object"==typeof t.opts.content?w(t.opts.content).html():t.opts.content,i='<div><div class="popover" id="'+o+'"><div class="popover-container"><div class="popover-inner"><div class="popover-title">'+t.opts.title+'</div><div class="popover-content">'+i+'</div></div><div class="popover-arrow"></div></div></div></div>';e.append(i),t.product=w("#"+o),t.wrapper=t.product.parent("div"),this.place()},o.prototype.place=function(){var t=this,e=[],o=this.ele,i=this.wrapper,p=this.product,n=w(window),h=o.offset().left,r=o.offset().top,s=o.outerWidth(),l=o.outerHeight(),c=n.scrollLeft(),d=n.scrollTop(),o=n.outerWidth(!0),n=n.outerHeight(!0),a=p.outerWidth(!0),u=p.outerHeight(!0),o={w1:o-(h-c),w2:o-(h-c)-s,w3:h-c+s,w4:h-c,w5:2*(Math.min(h-c,o-s-h+c)+s/2)},d={h1:r-d,h2:n-(h-c),h3:n-(r-d)-l,h4:r-d+l,h5:2*(Math.min(r-d,n-l-r+d)+l/2)},l={t1:r-u,t2:r-8,t3:r+l,t4:r+l-u+8,t5:r+(l-u)/2},s={l1:h-8,l2:h+s,l3:h+s-a+8,l4:h-a,l5:h+(s-a)/2},s=[{name:"topLeft",width:o.w1,height:d.h1,top:l.t1,left:s.l1},{name:"top",width:o.w5,height:d.h1,top:l.t1,left:s.l5},{name:"topRight",width:o.w3,height:d.h1,top:l.t1,left:s.l3},{name:"rightTop",width:o.w2,height:d.h2,top:l.t2,left:s.l2},{name:"right",width:o.w2,height:d.h5,top:l.t5,left:s.l2},{name:"rightBottom",width:o.w2,height:d.h4,top:l.t4,left:s.l2},{name:"bottomLeft",width:o.w1,height:d.h3,top:l.t3,left:s.l1},{name:"bottom",width:o.w5,height:d.h3,top:l.t3,left:s.l5},{name:"bottomRight",width:o.w3,height:d.h3,top:l.t3,left:s.l3},{name:"leftTop",width:o.w4,height:d.h2,top:l.t2,left:s.l4},{name:"left",width:o.w4,height:d.h5,top:l.t5,left:s.l4},{name:"leftBottom",width:o.w4,height:d.h4,top:l.t4,left:s.l4}];if(w.each(s,function(t,o){o.width>=a&&o.height>=u&&e.push(o)}),t.opts.autoPlace)if(e.length){for(var f=e[0],m=e.length-1;0<=m;m--)if(e[m].name===t.opts.placement){f=e[m];break}}else f=s[t.posId];else f=s[t.posId];i.css({position:"absolute",top:f.top+"px",left:f.left+"px"}),p.addClass("popover-"+f.name),i.mouseenter(function(){t.show()}),"click"!==t.opts.trigger&&"focus"!==t.opts.trigger&&i.mouseleave(function(){t.destroy()})},o.prototype.bind=function(){var o=this,t=this.opts.trigger,e=w(this.ele);switch(t){case"click":e.on("click",function(t){t.stopPropagation(),o.product=w("#"+o.pid),o.product.length?o.destroy():(o.mouse=!1,o.show())}),w(document).on("click",function(t){w(t.target).closest(".popover").length||w(".popover").parent("div").remove()});break;case"focus":e.on({focus:function(){o.product=w("#"+o.pid),o.product.length||(o.mouse=!1,o.show())},blur:function(){o.product=w("#"+o.pid),o.product.length&&o.destroy()}});break;default:e.hover(function(){o.show()},function(){o.destroy()})}},o.prototype.show=function(){var t=this;window.clearTimeout(t.timer_out),t.mouse||(t.timer_in=window.setTimeout(function(){t.mouse=!0,t.render()},t.opts.delay))},o.prototype.destroy=function(){var t=this;window.clearTimeout(t.timer_in),t.timer_out=window.setTimeout(function(){t.mouse=!1,w(".popover").parent("div").remove(),t.product=null},t.opts.delay)},w.fn.popover=function(t){return this.each(function(){return new o(this,t)})}}(jQuery);